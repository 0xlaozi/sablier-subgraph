type RawStream @entity {
  id: ID!
  interval: BigInt!
  payment: BigInt!
  recipient: Bytes!
  redemption: Redemption
  sender: Bytes!
  startBlock: BigInt!
  stopBlock: BigInt!
  streams: [Stream!]! @derivedFrom(field: "rawStream")
  token: Token
  txs: [Transaction!]! @derivedFrom(field: "rawStream")
  withdrawals: [Withdrawal!]! @derivedFrom(field: "rawStream")
}

type Stream @entity {
  id: ID!
  flow: StreamFlow!
  owner: Bytes!
  rawStream: RawStream!
  timestamp: Int!
}

# Both the sender and the recipient can withdraw money
# Figure out the total earned amount of money by adding up all the withdrawals
# with the value of "recipient" in the Redemption entity
type Redemption @entity {
  id: ID!
  recipientAmount: BigInt!
  senderAmount: BigInt!
}

type Token @entity {
  id: ID!
  decimals: Int
  name: String
  symbol: String
}

type Transaction @entity {
  id: ID!
  block: Int!
  event: String!
  rawStream: RawStream!
  timestamp: Int!
}

# Only the recipient can withdraw money
type Withdrawal @entity {
  id: ID!
  amount: BigInt!
  rawStream: RawStream!
}

enum StreamFlow {
  UNDEFINED
  IN
  OUT
}
